{"version":3,"file":"lesson-12-main-BWz01mve.js","sources":["../../src/js/lessons-12/pixabay-api.js","../../src/js/lessons-12/refs-les12.js","../../src/js/lessons-12/render-function.js","../../src/js/lesson-12-main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function getPhotos(query, page) {\n  const BASE_URL = 'https://pixabay.com/api/?';\n  const API_KEY = '45713433-433c1b648e48abad27090f3cc';\n\n\n  try {\n    const responce = await axios.get(`${BASE_URL}`, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: false,\n        per_page: '15',\n        page,\n      }\n    })\n    return responce.data\n  } catch (error) {\n    console.log('Помилка при завантаженні фото:', error)\n  }\n}\n","export const  refsLes12 = {\n  searchForm: document.querySelector('.search-form'),\n  startSearchBtn: document.querySelector('.js-start-search'),\n  galleryEl: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  moreSearchBtn: document.querySelector('.js-search-more')\n}","export function createMarkupGallery(data) {\n  const markupGallery = data.hits.map(item => {\n    const { webformatURL, largeImageURL, tags, likes, views, comments, downloads } = item;\n    return `\n            <li class=\"gallery-item\">\n              <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                <img\n                  class=\"gallery-image\"\n                  src=\"${webformatURL}\"\n                  alt=\"${tags}\"\n                  loading=\"lazy\"\n              /></a>\n              <ul class=\"img-content-wrapper\">\n                <li class=\"img-content-descr\">Likes<span>${likes}</span></li>\n                <li class=\"img-content-descr\">Views<span>${views}</span></li>\n                <li class=\"img-content-descr\">Comments<span>${comments}</span></li>\n                <li class=\"img-content-descr\">Downloads<span>${downloads}</span></li>\n              </ul>\n            </li>\n      `;\n  }).join(''); \n\n  return markupGallery;\n}\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getPhotos } from \"./lessons-12/pixabay-api\";\nimport { refsLes12 } from \"./lessons-12/refs-les12\";\nimport { createMarkupGallery } from \"./lessons-12/render-function\";\n\n// Додаємо обробники подій\nrefsLes12.searchForm.addEventListener('submit', submitFormSearch);\nrefsLes12.moreSearchBtn.addEventListener('click', handleClickMoreSearchBtn);\n\nfunction disableMoreSearchBtnOf() {\n  refsLes12.moreSearchBtn.classList.add('visually-hidden');\n}\ndisableMoreSearchBtnOf()\n\nfunction enableMoreSearchBtnOf() {\n  refsLes12.moreSearchBtn.classList.remove('visually-hidden');\n}\n\nlet searchPage = 1; // Номер сторінки для пошуку\nlet query = ''; // Запит для пошуку\nlet gallery; // Зберігаємо посилання на галерею\n\nasync function submitFormSearch(event) {\n  event.preventDefault(); // Зупиняємо стандартну поведінку форми\n  refsLes12.galleryEl.innerHTML = ''; // Очищуємо галерею перед новим пошуком\n  query = event.target.search.value; // Отримуємо значення з поля пошуку\n\n  refsLes12.loader.classList.remove('visually-hidden'); // Показуємо лоадер\n\n  try {\n    searchPage = 1; // Скидаємо номер сторінки на 1\n    const photos = await getPhotos(query, searchPage); // Викликаємо функцію getPhotos з запитом\n    \n    // Перевіряємо, чи є результати\n    if (!photos.hits || photos.hits.length === 0) {\n      iziToast.show({\n        title: '❌', \n        message: `Sorry, there are no images matching your search \"${query}\". Please try again!`,\n        color: 'red',\n        backgroundColor: '#ffcccc',\n        position: 'topRight',\n        timeout: 5000,\n        close: true,\n        pauseOnHover: true,\n        progressBar: true,\n      });\n      return; // Якщо немає результатів, виходимо з функції\n    }\n    \n    let total = photos.totalHits;\n    // Перевіряємо, скільки сторінок\n    if (searchPage * 15 < total) {\n      enableMoreSearchBtnOf(); // Показати кнопку, якщо ще є результати\n    } else {\n      disableMoreSearchBtnOf(); // Сховати кнопку, якщо досягли кінця результатів\n    }\n    \n    // Створюємо розмітку галереї з отриманих фото\n    const markup = createMarkupGallery(photos);\n    refsLes12.galleryEl.insertAdjacentHTML('afterbegin', markup); // Додаємо розмітку в галерею\n\n    // Ініціалізуємо SimpleLightbox\n    gallery = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n\n  } catch (error) {\n    showErrorToast('Щось пішло не так, спробуйте ще раз пізніше.');\n  } finally {\n    // Сховати лоадер в будь-якому випадку\n    refsLes12.loader.classList.add('visually-hidden');\n  }\n}\n\n\n\n\n\n\nasync function handleClickMoreSearchBtn(event) {\n  searchPage += 1; // Збільшуємо номер сторінки\n  refsLes12.loader.classList.remove('visually-hidden')\n  try {\n    const morePhotos = await getPhotos(query, searchPage); // Отримуємо більше фотографій\n    \n    if (!morePhotos || morePhotos.length === 0) {\n      disableMoreSearchBtnOf();\n      showErrorToast(\"We're sorry, but you've reached the end of search results.\");\n      return; // Якщо більше немає результатів, виходимо з функції\n    }\n\n    let total = morePhotos.totalHits;\n\n    // Створюємо розмітку з нових фотографій\n    const markup = createMarkupGallery(morePhotos); \n    refsLes12.galleryEl.insertAdjacentHTML('beforeend', markup); // Додаємо розмітку в кінець галереї\n\n    // Оновлюємо SimpleLightbox\n    gallery.refresh(); // Оновлюємо галерею, щоб включити нові зображення\n\n  } catch (error) {\n    showErrorToast('Щось пішло не так, спробуйте ще раз пізніше.');\n  } finally {\n    // Сховати лоадер в будь-якому випадку\n    refsLes12.loader.classList.add('visually-hidden');\n  }\n}\n\nfunction showErrorToast(message) {\n  iziToast.show({\n    title: 'Помилка',\n    message,\n    color: 'red',\n    position: 'topRight',\n    timeout: 5000,\n  });\n}\n"],"names":["getPhotos","query","page","BASE_URL","API_KEY","axios","error","refsLes12","createMarkupGallery","data","item","webformatURL","largeImageURL","tags","likes","views","comments","downloads","submitFormSearch","handleClickMoreSearchBtn","disableMoreSearchBtnOf","enableMoreSearchBtnOf","searchPage","gallery","event","photos","iziToast","total","markup","SimpleLightbox","showErrorToast","morePhotos","message"],"mappings":"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"}